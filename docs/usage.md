# Usage Guidance

For commands please refer to the guidance of each below. Behaviors of commands depend on their execution scopes, those are: `Global`, `Project`, `Service`.

## Gokums project

A project generated by `Gok` is called `Gokums` project. A project like these specified by a yaml file called [root.yaml configuration](others/root.yaml.md). A service is a subfolder inside a project and configured by another special yaml file call [manifest.yaml](others/manifest.yaml.md).

The scope of the command is defined by the current folder you are in. If your current folder is in the `service scope`, means you are in a folder contains a `manifest.yaml` or one of your parent folders has it. The same thing applies to the `project scope`, means that you are not in a `service`, but your current folder or its parent contain a `root.yaml`.  The `Global scope` implies that your current folder is not in any project or service.

## Gokums command list
- [Gok doctor](commands/doctor.md)
- [Gok generate](commands/generate.md)
- [Gok build](commands/build.md)
- [Gok flag](commands/flag.md)
- [Gok navigate](commands/navigate.md)
- [Gok plugin](commands/plugin.md)
- [Gok run](commands/run.md)
- [Gok task](commands/task.md)
- [Gok yml](commands/yml.md)

Also to type command faster, check the [Command alias](others/alias.md)
Check [Gokums conventions](others/conventions.md) for better understanding of the `Gokums`

## Create a new project

The `generate` command will be used to create the basic project, derived from the standard template structure.

Note, the `generate` command can be abbreviated to `g`. This also assumes GitHub is the repository for code, and therefore the path follows `golang` conventions.

```shell
echo go navigate setup > ~/.bash_rc
source ~/.bash_rc
gok g project github.com/gokums/sample
gokto gokums-sample
git remote add origin git@github.com:orgname/projectname.git
git push -u origin master
```

## Generate Interface specifications

See `Generate Gateway` below for specific Proto generation details for API Gateway services.

### Define specification

[Protobuf](https://github.com/google/protobuf) `proto` files are used to define the interfaces for deployable components.

Assumption: These commands are executed from the root project directory.
In the example created above, that will be `$GOPATH/src/github.com/orgname/projectname`.

```shell
gok g proto protoname
```

This will create a subdirectory containing the `proto` file which can be updated with your specifications.
Note, there is additional commenting in the `proto` file which explains how to configure optional proto validations.

### Generate `golang` files

The `build` command (aliased to `b`) is used to compile `proto` files into the necessary `golang` source.

```shell

# Build a single proto file
gok b proto protofile
# Build all proto files
gok b proto
# Build a single proto file with validations enabled
gok b proto protofile -v
```

## Generate Gateway

`proto` files will also be used to define a Gateway's API specification.

### Define gateway specification

```shell
gok g gateway gatewayprotofile
```

This will define `proto` file in the `proto\gateway` subdirectory.

This proto can be built in the same way as other proto files, using the `gok b proto` command.

## Create service

This applies to the creation of both Gateway services, or other standard services.

```shell
gok g service servicename
```

This creates a service `golang` code, and associated configurations files in the `src\servicename` subdirectory.

If you wish to logically arrange other services into packages, you can create a service using the following command.

```shell
gok g service servicename1 -p helpers
gok g service servicename2 -p helpers
```

This will create `src\helpers\servicename1` and `src\helpers\servicename2`.

## Other utility tooling

### Project Source navigation

This is done by using the `navigate` command, which is aliased to `nav`.
`projectname` is a project that was previously created using the `generate` command.

```shell
gok nav to projectname
```

The command above only prints out the path to the `projectname`. If you want a command to change to that folder, you need to source `gok nav setup` into your `bashrc` file. Depend on your terminal, it can be one of these: `~/.bashrc`, `~/.bash_profile`, `~/.profile`...
For example:

```shell
gok nav setup >> ~/.profile
source ~/.profile
```

Now you can use
```shell
gokto projectname
gokto servicename
```
It is smart enough to grep a part of `projectname` or `servicename`, as well as detect if you are in a project or not. Give it a try.